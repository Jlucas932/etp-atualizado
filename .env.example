# ============================================================================
# CONFIGURAÇÃO AUTODOC-IA v2.0 - AMBIENTE DE PRODUÇÃO ON-PREMISES
# ============================================================================
# Este arquivo documenta TODAS as variáveis de ambiente suportadas.
# Copie para .env e ajuste os valores conforme seu ambiente.
# ============================================================================

# ----------------------------------------------------------------------------
# OPENAI / MODELO DE LINGUAGEM
# ----------------------------------------------------------------------------
# Chave de API da OpenAI (obrigatória)
# Obtenha em: https://platform.openai.com/api-keys
OPENAI_API_KEY=sua_api_key_aqui

# Base URL da API OpenAI (opcional, para usar proxies ou providers alternativos)
OPENAI_API_BASE=https://api.openai.com/v1

# ----------------------------------------------------------------------------
# FLASK / APLICAÇÃO
# ----------------------------------------------------------------------------
# Chave secreta do Flask para sessões e cookies (MUDE EM PRODUÇÃO!)
SECRET_KEY=asdf#FGSgvasgf$5$WGT

# Ambiente de execução: development, production, testing
FLASK_ENV=production

# Debug mode (SEMPRE False em produção!)
FLASK_DEBUG=0
DEBUG=False

# ----------------------------------------------------------------------------
# SERVIDOR
# ----------------------------------------------------------------------------
# Host e porta do servidor (0.0.0.0 para aceitar conexões externas)
HOST=0.0.0.0
PORT=5002

# ----------------------------------------------------------------------------
# BANCO DE DADOS
# ----------------------------------------------------------------------------
# URL completa de conexão (formato SQLAlchemy)
# Exemplos:
#   PostgreSQL: postgresql+psycopg2://user:pass@localhost:5432/dbname
#   MySQL:      mysql+pymysql://user:pass@localhost:3306/dbname
#   SQL Server: mssql+pyodbc://user:pass@localhost:1433/dbname?driver=ODBC+Driver+17+for+SQL+Server
#   SQLite:     sqlite:///./data/autodoc.db
DATABASE_URL=postgresql+psycopg2://az_etp_user:az_etp_password_2024@localhost:5432/az_etp_db

# Configurações de pool de conexões
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=10
DB_POOL_RECYCLE=3600
DB_POOL_PRE_PING=true

# Vendor do banco (opcional, detectado automaticamente da DATABASE_URL)
# Valores: postgresql, mysql, mssql, sqlite
DB_VENDOR=postgresql

# ----------------------------------------------------------------------------
# EMBEDDINGS E RAG
# ----------------------------------------------------------------------------
# Provider de embeddings: openai (padrão)
EMBEDDINGS_PROVIDER=openai

# Caminho do índice FAISS (relativo à raiz do projeto)
RAG_FAISS_PATH=src/main/python/rag/index/faiss

# Top-K documentos retornados pelo RAG
RAG_TOPK=5

# Configurações de busca híbrida (BM25 + FAISS)
RAG_MIN_DOCS=2
RAG_MIN_SCORE=0.5
W_LEX=0.5
W_SEM=0.5

# Configurações de chunking de documentos
CHUNK_SIZE=1000
CHUNK_OVERLAP=150

# Diretório de cache de embeddings
EMBED_CACHE_DIR=./cache/embeddings

# ----------------------------------------------------------------------------
# LOGGING
# ----------------------------------------------------------------------------
# Nível de log: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# ----------------------------------------------------------------------------
# SEGURANÇA
# ----------------------------------------------------------------------------
# Proteção XSS e sanitização de HTML
XSS_PROTECTION=true
SANITIZE_HTML=true

# Token para acessar endpoint /metrics (Prometheus)
# GERE UM TOKEN SEGURO EM PRODUÇÃO!
METRICS_TOKEN=change_me_in_production_12345

# ----------------------------------------------------------------------------
# CORS (Cross-Origin Resource Sharing)
# ----------------------------------------------------------------------------
# Origens permitidas para requisições cross-origin (separadas por vírgula)
# 
# DESENVOLVIMENTO: Use "*" para aceitar todas as origens
# PRODUÇÃO: Liste origens específicas para segurança
# 
# Exemplos:
#   Desenvolvimento:  CORS_ORIGINS=*
#   Produção:         CORS_ORIGINS=https://app.exemplo.com.br,https://admin.exemplo.com.br
#   Localhost:        CORS_ORIGINS=http://localhost:3000,http://localhost:8080
CORS_ORIGINS=*

# ----------------------------------------------------------------------------
# UPLOAD DE ARQUIVOS
# ----------------------------------------------------------------------------
# Tamanho máximo de upload em MEGABYTES (não bytes!)
# Valor padrão: 16 MB
# 
# Ajuste conforme necessidade:
#   Documentos pequenos: 10 MB
#   Documentos médios:   50 MB
#   Documentos grandes:  100 MB
# 
# ATENÇÃO: Valores muito altos podem causar problemas de memória
MAX_CONTENT_LENGTH=16

# ----------------------------------------------------------------------------
# RATE LIMITING
# ----------------------------------------------------------------------------
# Requisições por minuto por IP
RATE_LIMIT_PER_MINUTE=30

# ----------------------------------------------------------------------------
# SESSÕES
# ----------------------------------------------------------------------------
# Persistência de sessões entre reinicializações
SESSION_PERSISTENCE=true

# Timeout de sessão em segundos (1 hora padrão)
SESSION_TIMEOUT=3600

# ----------------------------------------------------------------------------
# INTEGRAÇÕES EXTERNAS
# ----------------------------------------------------------------------------
# Timeout para consultas ao LexML (normas legais)
LEXML_TIMEOUT_SECONDS=8

# TTL do cache de normas legais (em dias)
LEGAL_CACHE_TTL_DAYS=7

# ----------------------------------------------------------------------------
# PAINEL ADMINISTRATIVO
# ----------------------------------------------------------------------------
# Credenciais do admin (MUDE EM PRODUÇÃO!)
ADMIN_USER=admin
ADMIN_PASS=admin123

# ----------------------------------------------------------------------------
# PARSER E PROCESSAMENTO
# ----------------------------------------------------------------------------
# Parser JSON relaxado (aceita JSON malformado)
JSON_PARSER_RELAXED=true

# Desabilitar fallback "suicida" (tentativas agressivas de parsing)
FALLBACK_SUICIDA_DISABLED=true

# ----------------------------------------------------------------------------
# MODO DE INGESTÃO
# ----------------------------------------------------------------------------
# Modo de ingestão de documentos: pdf, json
INGEST_MODE=pdf

# ----------------------------------------------------------------------------
# GUNICORN (PRODUÇÃO)
# ----------------------------------------------------------------------------
# Número de workers (recomendado: 2-4 x CPU cores)
GUNICORN_WORKERS=4

# Número de threads por worker
GUNICORN_THREADS=2

# Timeout de requisições (segundos)
GUNICORN_TIMEOUT=120

# Bind address
GUNICORN_BIND=0.0.0.0:5002

# ----------------------------------------------------------------------------
# OBSERVABILIDADE
# ----------------------------------------------------------------------------
# Habilitar métricas Prometheus
ENABLE_METRICS=true

# Habilitar tracing (futuro)
ENABLE_TRACING=false
